<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AplicaÈ›ie GermanÄƒ CompletÄƒ</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; background: #f0f2f5; padding-top: 85px; }
        #top-bar { position: fixed; top: 0; left: 0; width: 100%; height: 75px; background: #28a745; color: white; 
                   display: flex; align-items: center; justify-content: center; z-index: 1000; font-weight: bold; padding: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.2); font-size: 17px; }
        .card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .section-title { font-size: 12px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 10px; display: block; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 10px; }
        .btn { border: none; padding: 12px; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; font-size: 13px; text-align: center; }
        .a1 { background: #4caf50; } .a2 { background: #009688; } .b1 { background: #ff9800; }
        .b2 { background: #e91e63; } .c1 { background: #673ab7; } .propriu { background: #007bff; }
        
        .news-item { background: #f0f7ff; padding: 12px; border-radius: 8px; margin-bottom: 8px; border-left: 4px solid #007bff; cursor: pointer; }
        .news-title { font-weight: bold; font-size: 14px; display: block; }
        .news-sub { font-size: 11px; color: #777; }

        #reader-area { line-height: 2.2; font-size: 20px; color: #1a1a1a; min-height: 100px; padding: 15px 0; white-space: pre-wrap; }
        .word { cursor: pointer; padding: 2px 4px; border-radius: 4px; display: inline-block; }
        .active-word { background: #ccffcc !important; border-bottom: 2px solid #28a745; }
        
        .btn-audio { width: 100%; padding: 16px; border-radius: 8px; margin-top: 10px; font-weight: bold; border: none; font-size: 16px; }
        .play-mode { background: #343a40; color: white; }
        .stop-mode { background: #dc3545; color: white; }
        
        .item-row { display: flex; justify-content: space-between; background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 5px; border: 1px solid #ddd; }
        textarea, input { width: 100%; border-radius: 8px; border: 1px solid #ddd; padding: 10px; font-size: 15px; margin-top: 5px; }
        .hidden { display: none; }
        .mini-spk { background: white; color: #28a745; border: none; border-radius: 50%; width: 30px; height: 30px; margin-left: 10px; cursor: pointer; font-size: 18px; }
    </style>
</head>
<body>

<div id="top-bar">ApasÄƒ pe un cuvÃ¢nt sau o È™tire</div>

<div class="card">
    <span class="section-title">Nivele Studiu</span>
    <div class="grid">
        <button class="btn a1" onclick="incarcaPreset('a1')">A1</button>
        <button class="btn a2" onclick="incarcaPreset('a2')">A2</button>
        <button class="btn b1" onclick="incarcaPreset('b1')">B1</button>
        <button class="btn b2" onclick="incarcaPreset('b2')">B2</button>
        <button class="btn c1" onclick="incarcaPreset('c1')">C1</button>
        <button class="btn propriu" onclick="toggleSectiune('zona-adaugare')">+ PROPRIU</button>
    </div>
    
    <div id="zona-adaugare" class="hidden">
        <input type="text" id="inp-titlu" placeholder="Titlu (LecturÄƒ sau Test)...">
        <textarea id="inp-text" placeholder="Text pentru lecturÄƒ SAU perechi 'CuvÃ¢nt,Traducere' pentru Test..."></textarea>
        <div style="display:flex; gap:5px; margin-top:5px;">
            <button class="btn propriu" style="flex:1" onclick="salveaza('L')">SalveazÄƒ LecturÄƒ</button>
            <button class="btn propriu" style="flex:1; background:#673ab7" onclick="salveaza('T')">SalveazÄƒ Test</button>
        </div>
    </div>
</div>

<div class="card">
    <span class="section-title">ğŸ“° È˜tiri Live Germania</span>
    <div id="news-container">
        <div class="news-item" onclick="incarcaStire(0)">
            <span class="news-title">US-Regierung: Zuversicht trotz Zoll-Chaos</span>
            <span class="news-sub">ApasÄƒ pentru a studia È™tirea...</span>
        </div>
        <div class="news-item" onclick="incarcaStire(1)">
            <span class="news-title">Entscheidende Woche im Tarifstreit</span>
            <span class="news-sub">ApasÄƒ pentru a studia È™tirea...</span>
        </div>
    </div>
</div>

<div class="card">
    <span class="section-title">ğŸ“‚ Materialele Mele</span>
    <div id="lista-materiale"></div>
</div>

<div class="card">
    <span class="section-title">ğŸ“– Cititor Activ</span>
    <div id="reader-area">SelecteazÄƒ un nivel, o È™tire sau un material propriu...</div>
    <button id="main-audio-btn" class="btn-audio play-mode hidden" onclick="controlAudio()">ğŸ”Š AscultÄƒ Textul Complet</button>
</div>

<script>
    let synth = window.speechSynthesis;
    let textCurent = "";
    const stiriText = [
        "US-Regierung: Demonstrative Zuversicht trotz Zoll-Chaos. US-Finanzminister Bessent setzt weiter auf die aggressive Zollpolitik.",
        "Entscheidende Woche im Tarifstreit bei der Bahn. Ab morgen sollen die neuen Verhandlungen beginnen."
    ];
    const preset = { 'a1': "Hallo! Ich bin Thomas. Ich wohne in Berlin.", 'c1': "Die Implementierung neuer Technologien erfordert Analyse." };

    window.onload = refreshLista;

    function toggleSectiune(id) { document.getElementById(id).classList.toggle('hidden'); }

    function incarcaPreset(n) { afiseaza(preset[n] || "Text nivel " + n); }
    function incarcaStire(i) { afiseaza(stiriText[i]); }

    function afiseaza(t) {
        textCurent = t;
        document.getElementById('reader-area').innerHTML = t.split(/\s+/).map(w => `<span class="word" onclick="tradu(this)">${w}</span>`).join(' ');
        document.getElementById('main-audio-btn').classList.remove('hidden');
        stopAudio();
    }

    function tradu(el) {
        document.querySelectorAll('.word').forEach(w => w.classList.remove('active-word'));
        el.classList.add('active-word');
        let c = el.innerText.replace(/[.,!?;:()]/g, '');
        fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=de&tl=ro&dt=t&q=${c}`)
            .then(r => r.json()).then(data => {
                let trad = data[0][0][0];
                document.getElementById('top-bar').innerHTML = `<b>${c}</b> = ${trad} <button class="mini-spk" onclick="redaSf('${c}')">ğŸ”Š</button>`;
            });
    }

    function salveaza(tip) {
        const t = document.getElementById('inp-titlu').value || "Nou";
        const c = document.getElementById('inp-text').value;
        if(!c) return;
        let db = JSON.parse(localStorage.getItem('mea_data') || '[]');
        db.push({ titlu: t, continut: c, tip: tip });
        localStorage.setItem('mea_data', JSON.stringify(db));
        refreshLista(); toggleSectiune('zona-adaugare');
    }

    function refreshLista() {
        const cont = document.getElementById('lista-materiale');
        let db = JSON.parse(localStorage.getItem('mea_data') || '[]');
        cont.innerHTML = db.map((item, i) => `
            <div class="item-row">
                <span onclick="deschide(${i})" style="cursor:pointer"><b>${item.tip == 'L' ? 'ğŸ“„' : 'ğŸ§ '} ${item.titlu}</b></span>
                <span onclick="sterge(${i})" style="color:red; cursor:pointer">X</span>
            </div>
        `).join('');
    }

    function deschide(i) {
        let db = JSON.parse(localStorage.getItem('mea_data') || '[]');
        let itm = db[i];
        if(itm.tip == 'L') afiseaza(itm.continut);
        else runTest(itm.continut);
    }

    function runTest(raw) {
        let p = raw.split('\n').map(l => l.split(',')).filter(x => x.length==2);
        let s = 0;
        p.forEach(q => {
            let r = prompt("Tradu: " + q[0]);
            if(r && r.toLowerCase().trim() == q[1].toLowerCase().trim()) s++;
        });
        alert("Scor: " + s + "/" + p.length);
    }

    function sterge(i) {
        let db = JSON.parse(localStorage.getItem('mea_data') || '[]');
        db.splice(i, 1);
        localStorage.setItem('mea_data', JSON.stringify(db));
        refreshLista();
    }

    function redaSf(c) { stopAudio(); let u = new SpeechSynthesisUtterance(c); u.lang = 'de-DE'; synth.speak(u); }
    function controlAudio() {
        if(synth.speaking) stopAudio();
        else {
            let u = new SpeechSynthesisUtterance(textCurent); u.lang = 'de-DE';
            u.onstart = () => { document.getElementById('main-audio-btn').innerHTML = "â¹ OpreÈ™te Citirea"; document.getElementById('main-audio-btn').className = "btn-audio stop-mode"; };
            u.onend = stopAudio;
            synth.speak(u);
        }
    }
    function stopAudio() { synth.cancel(); let b = document.getElementById('main-audio-btn'); b.innerHTML = "ğŸ”Š AscultÄƒ Textul Complet"; b.className = "btn-audio play-mode"; }
</script>
</body>
</html>
